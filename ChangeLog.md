
更新履歴 - ChangeLog
====================

2.4.1 : 2015/0x/xx
------------------
#### 仕様変更
- WEB UI の項目「最新話掲載日」をArcadia及び暁にも対応させました
	- それに伴い `narou u --gl` コマンドもArcadiaと暁に対応します
- `narou u --gl` コマンドが凍結済み小説は無視するように変更しました


2.4.0 : 2015/05/16
------------------
#### 追加機能
- WEB UI に保存フォルダを開くためのボタンを表示する項目「保存先」を追加しました
- WEB UI に項目「最新話掲載日」を追加しました
	+ 「小説家になろう」と「ハーメルン」のみ対応しています（updateした小説から
	  反映されていきます）。更新が無いと反映されないため、手動で反映させたい場合
	  はWEB UI サーバを落とした状態で `narou u --gl` コマンドを使用して下さい

#### 仕様変更
- 小説リストの「新着」及び「更新」の表示基準を調整しました
- replace.txt による置換を行うタイミングを変更しました
	+ 今までは (before→本体処理→after)＊話数分→置換 という処理順だったものが、
	  (before→本体処理→after→置換)＊話数分 という処理順になりました

#### Bug Fix
- `enable_insert_word_separator` を有効にした場合に発生する以下の不具合を修正
	+ 開きカッコの禁則処理が Kindle で処理されなくなる
	+ replace.txt による置換が正常に行われない場合がある
	+ URLが含まれている文章の単語分割が正常に行われない
- あらすじだけ更新された場合にデータベースが更新されていなかった不具合を修正
- 小説サイトのサーバーがダウンしている時にエラーがでる問題を修正
- WEB UI の小説リストにおいて、更新・新着の表示期間が過ぎているにも関わらず、
  アップデート等をした際に消えない不具合を修正
- ハーメルンで非公開になっている小説をアップデートするとエラーになる不具合
  を修正


2.3.3 : 2015/04/24
------------------
#### Bug Fix
- `enable_ruby_youon_to_big` で拗音が大きくならない場合があったのを修正
- WEB UI 起動中にタイトルやあらすじが変更された場合に反映されない場合があった
  のを修正
	+ アップデート時に10分以上経ったキャッシュは捨てるようにしました


2.3.2 : 2015/04/01
------------------
#### Bug Fix
- `enable_insert_char_separator` でルビ及び外字注記が壊れる問題を修正


2.3.1 : 2015/03/24
------------------
#### Bug Fix
- `enable_insert_word_separator` の動作が単語単位ではなく文字単位で選択になって
  しまっていたのを修正
	- 文字単位での選択は `enable_insert_char_separator` という設定で出来るように
	  しました
- 漢数字変換を無効にした場合に章見出しの自動インデント機能が壊れる問題を修正


2.3.0 : 2015/03/21
------------------
#### 追加機能
- Kindle端末で単語の選択を出来るようにするために、小説別変換設定に
  `enable_insert_word_separator` オプションが追加されました
	+ このオプションを使うためには `narou init` を実行して AozoraEpub3 の設定を
	  修正する必要があります
	+ 各小説の setting.ini 内に `enable_insert_word_separator=true` と追加で書き
	  込むか、 `narou s force.enable_insert_word_separator=true` とコマンドを打ち
	  込むことで有効に出来ます。（WEB UI で設定すると楽です）
	+ このオプションは、Kindle端末で単語が選択出来ない問題に対応するものです。
	  device が kindle の時のみ使用可能です。また、Send to Kindle で mobi を azw3
	  に変換する場合は単語選択は可能なので、設定する必要はありません

#### Bug Fix
- ハーメルンの仕様変更に対応しました


2.2.0 : 2015/02/19
------------------
#### 追加機能
- 漢字の二と間違えてカタカナのニを使っていそうなのを漢字に変換する機能を、設定
  でON/OFF出来るようにしました
	+ setting.ini の enable_kana_ni_to_kanji_ni を設定することで変更が可能です
	+ また、変換した場合は調査結果に記録されるようになります
- `update.convert-only-new-arrival` オプションが追加されました
	+ 新着時のみ変換を実行する `update` コマンドの `--convert-only-new-arrival`
	  を `setting` コマンドでも設定出来るようにするためのものです
	+ `narou s update.convert-only-new-arrival=true` で設定出来ます

#### Bug Fix
- アップデートのログ保存時に文字エンコーディングを指定するようにした
- Linux で `web` コマンド実行時にエラーが出ていたのを修正
- カタカナのニを漢字の二に変換する対象を調整
- Koboで前書き・後書きのレイアウトが崩れないように調整

2.1.0 : 2015/01/19
------------------
#### 追加機能
- `convert.multi-device` オプションが追加されました
	+ `convert` コマンド使用時に複数のフォーマットへ同時に変換することが出来ます
	+ `narou s convert.multi-device=kindle,kobo,reader` のようにカンマ区切りで
	  設定します。この設定を有効にした場合、変換時に `device` 設定は無視されます
	+ `send` コマンド時には通常通り `device` の設定が使用されます
	+ 普通のEPUBが出力したい場合、端末名として `epub` を指定して下さい
- `update.logging` オプションが追加されました
	+ `update` コマンド使用時にログを保存するようになります
	+ `narou s update.logging=true` で設定出来ます
	+ ログはテキストファイルとして `log/` フォルダに保存されます(最新30件まで)。
	  また、 `narou u --log N` コマンドでも確認出来ます(N=1以上の整数)。
		Nを省略した場合は最新のログが表示されます。短縮する場合は `narou u -l N`
- `send.backup-bookmark` オプションが追加されました
	+ `send` コマンド使用時に端末の栞データを自動でバックアップします(KindlePW系
	  専用。他の端末も栞データの仕様が分かれば対応可能)
	+ `narou s send.backup-bookmark=true` で設定出来ます
	+ 一括送信時(`narou send` とだけコマンドを打った時)のみバックアップします
	+ 上記設定をせずに手動でバックアップする場合は `narou send --backup-bookmark`
	  もしくは `narou send -b` で行います
	+ バックアップした栞データを復元（端末にコピー）するには
	  `narou send --restore-bookmark` もしくは `narou send -r` で行います
- 変換設定に行頭字下げを強制的に行う `enable_force_indent` を追加しました
	+ enable_auto_indent は作者の意図的な字下げ無しを考慮して、全体的に字下げが
	  行われていない時にのみ字下げをするのに対して、今回のオプションは強制的に
	  字下げを行います。作者の字下げ忘れが多い場合に有効です
- WEB UI用ブックマークレットを実行した時にサーバがオフラインかどうか分かるよう
  になりました。ヘルプ画面からブックマークレットを更新して下さい

#### 仕様変更
- `convert.copy_to` を `convert.copy-to` へ変更しました(表記ゆれの統一の為)
	+ copy_to も後方互換維持のため残されますが、今後は非推奨になります
- `flag` コマンドが削除されました

#### Bug Fix
- WEB UI: リロードしても変換中のプログレスバーが表示されるように修正 #57

#### その他
- 将来的に対応バージョンを上げる予定なので、古いRuby（2.1.0未満）を使用している
  場合にお知らせを表示するようになりました。当面は1.9.3でも動くままですが、いま
  のうちにRuby2.1.0以上へのアップグレードをお願いします


2.0.2 : 2015/01/16
------------------
#### 仕様変更
- 青空文庫形式のコメントの削除はWEB小説を変換する場合は無効にするように変更
- `web` コマンド実行時すでにサーバが立ち上がっていてもブラウザを開くように変更
- ダウンロード時に表示する節のタイトルを表示するタイミングを調整

#### Bug Fix
- WEB UI起動時には送信失敗リスト表示時に入力を求めないように修正
- ハーメルンの小説が非公開設定になるとエラーになるのを修正 #59
- `mail` コマンドで送信時にエラーが出る場合がある問題に対応


2.0.1 : 2014/12/26
------------------
#### Bug Fix
- ヘルプ画面の画像が表示出来ない場合があるのを修正


2.0.0 : 2014/12/26
------------------
#### 追加機能
- `web` コマンドを実装しました。ブラウザベースによるWEB UIを使うことが出来ます
	+ `narou web` でWEBサーバを起動し、自動的にブラウザが開きます
	+ ブラウザは可能な限り最新を推奨。IEは9以下は動きません
- `download.use-subdirectory` オプションが追加されました。小説IDの先頭数文字で
  サブフォルダを作成しグループ分けすることで、大量の小説を管理する場合のパフォ
  ーマンス劣化に対応します
	+ `narou s download.use-subdirectory=true` として設定出来ます
	+ すでに管理済みの小説の保存フォルダは変更されません
- ダウンロード時やアップデート時の最後に、容量不足等で書籍データを送信出来なか
  ったファイル一覧を表示するようにしました

#### 仕様変更
- 終了コードを整理しました
	+ 正常終了時：0
	+ 異常終了時：127
	+ updateコマンド及びdownloadコマンドで失敗した場合：失敗した小説の数
	+ settingコマンド：設定でエラーになった数
- 見出しリスト.txt を保存しなくなりました

#### Bug Fix
- 新規ダウンロードする際にエラーになる場合があったのを修正 #53
- 小説家になろうのルビ仕様に準拠していない書式があったのを修正

		｜が存在していなく、かつ《 》内に自動ルビ化対象文字以外がある場合に
		ルビ化はされない

- 上記修正に伴い、ログ・ホライズン（n8725k）の converter.rb を差し替えました
- Java がインストールされていない場合でも EPUB ファイルの作成が成功したと表示
  されてしまうのを修正 #55


1.7.2 : 2014/11/26
------------------
#### Bug Fix
- デバイスの容量不足で送信に失敗した小説が、再度送信されない問題を修正


1.7.1 : 2014/10/16
------------------
#### Bug Fix
- 暁の18禁小説がダウンロードできなかったのを修正


1.7.0 : 2014/09/27
------------------
#### 追加機能
- `list` コマンドの `--filter` オプションに `frozen` 及び `nonfrozen` が追加
  されました。凍結状態のフィルタリングが可能になります。また、同時に複数の値を
  受け付けるようになりました

		narou list -f frozen （凍結された小説のみ表示）
		narou list -f nonfrozen （凍結されていない小説のみ表示）
		narou list -f "ss nonfrozen" （凍結されていない短編を表示）

#### 仕様変更
- 英文判定文字に `&:;_-` を追加しました
	+ 今までおかしかった例：Tuez-les tous, Dieu reconnaitra les siens）
- 8文字以上の半角アルファベットは全角に変換せずに半角のままになります

#### Bug Fix
- 行頭が英文で始まる行がオートインデントできていなかったのを修正

#### その他
- 起動にかかる時間及び表示処理速度を向上させました(起動時間がv1.6に比べて約50%短縮)


1.6.4 : 2014/09/17
------------------
#### 追加機能
- `list` コマンドに `--echo` オプション(短縮：-e)を追加しました。パイプやリダ
  イレクトを経由してもリストをそのまま表示します。また、ANSIColorコードの削除
  も同時に行うので、--no-color オプションは必要ありません

1.6.3 : 2014/09/11
------------------
#### Bug Fix
- ハーメルン、Arcadiaにおいて小説が削除されている場合にエラーが出ていたのを修正
- １話も投稿されていない小説でエラーが出ていたのを修正

1.6.2 : 2014/09/08
------------------
#### 仕様変更
- あらすじだけ変更された場合も更新とみなすようになりました

#### Bug Fix
- `download.wait-steps` でウェイトを入れるタイミングがおかしくなっていたため、
  503エラーが頻発するようになっていたのを修正
- 完結しているにもかかわらず完結タグが付与されない場合があったのを修正。また、
  完結していた小説が連載を再開した場合、完結タグを削除するようになりました
- 話数が減っているにも関わらずダイジェスト化検知出来ない場合があったのを修正

1.6.1 : 2014/09/05
------------------
#### Bug Fix
- Ruby1.9.3において `tag` コマンドが使用出来ない問題を修正
- flag データを設定し、その後削除した場合に flag --convert-tag コマンドが
  クラッシュする問題を修正

1.6.0 : 2014/08/28
------------------
#### 追加機能
- **iBooks** での管理に対応しました
	+ Mac OS X Mavericks以上が対象です
	+ `narou s device=ibooks` で変更できます
	+ 初回登録時はiBooksでEPUBファイルを開くので、ウィンドウが大量に開くことに
	  ご注意ください。次回以降はiBooksの管理フォルダを直接更新してウィンドウが
	  開くことはありません
- **JRuby** での実行に対応しました（Windowsでは環境変数JAVA_OPTSに
  -Dfile.encoding=UTF8を設定して下さい）
- `diff` コマンドで外部ツールがなくても更新された部分の差分を表示できるように
  なりました
	+ `difftool` が設定されていない場合、独自の差分表示処理を行います。
	  小説用なので一文字単位の修正がわかりやすいように調整してあります

	  ![diff使用時のイメージ](https://raw.github.com/wiki/whiteleaf7/narou/images/diff_cap.png)
- `tag` コマンドが追加されました
	+ 小説に自由にタグを付けることができ、絞り込み等で使用出来ます
		+ タグを追加: `narou tag -a akatsuki 0`
		+ タグが付いた小説を表示: `narou tag akatsuki`
		+ コマンドの対象小説をタグで指定: `narou update akatsuki`
		+ その他詳細な説明は `narou tag -h` を参照して下さい
- `list` コマンドが拡張されます
	+ `--site` オプション(短縮: -s)が追加されました。掲載小説サイト名を合わせて
	  表示します
	+ `--author` オプション(短縮:-a)が追加されました。作者名を合わせて表示します
	+ `--tag` オプション(短縮: -t)が追加されました。タグで小説を検索出来ます
		* `narou l -t tagname` 、 `narou l -t "tag1 tag2"`
		* `narou l -t` と引数を省略すると全ての小説をタグつきで表示
	+ `--grep` オプション(短縮: -g)が追加されました。リストの中から指定された
	  文字列で検索します。最終的に表示される内容から検索するため、作者名やサイト
	  名等そのままでは表示されない要素から検索したい場合、それぞれを表示するオプ
	  ションも合わせて指定して下さい
		* 例1： リストから作者名に“紫炎”が含まれる小説を探したい場合
			- `narou list --author --grep 紫炎` 或いは `narou l -ag 紫炎`
		* 例2: 小説家になろう以外の小説を表示したい場合
			- `narou list --site --grep "-小説家になろう"` 或いは
			  `narou l -sg "-小説家になろう"` (-をつけることでNOT検索)
		* 例3: ハーメルンの小説からSAOを含む小説を探す
			- `narou l -sg "ハーメルン SAO"` (スペース区切りによるAND検索)
	+ listコマンドの結果をパイプで他のコマンドに接続できるようになりました
		* 例1: ハーメルに掲載されている小説にhamelnタグを付けたい
			- `narou l -sg ハーメルン | narou t -a hameln`
		* 例2: 短編を全て凍結したい
			- `narou l -f ss | narou freeze --on`
		* 注意点として、パイプでつないだ場合は remove コマンドは確認メッセージを
		  出さずに削除します
- `convert` コマンドに `--ignore-force` オプションが追加されました。
  `narou s force.設定名=値` として強制上書きされる設定を一時的に無効にします
- 空改行の削除処理を制御する `enable_pack_blank_line` オプションが追加されました
	+ デフォルトでは有効です。無効にするには各小説の setting.ini に
	  `enable_pack_blank_line=false` を追加するか、
	  `narou s force.enable_pack_blank_line=false` を実行して下さい
- `freeze` コマンドに強制凍結及び解除する `--on` 及び `--off` オプションが追加
  されました

#### 仕様変更
- `update.strong` の挙動を、「当日分は必ずDLする」から「当日分は内容を見て更新
  されているか確認する」に変更しました。またタイムスタンプを記録するようにし、
  アップデート時のパフォーマンスを向上させました
- デバイス設定時に最低限必要な関連項目を設定変更するようになりました
- 空改行の間引き具合を若干弱くしました
- `list` コマンドの `--type` オプションを `--kind` (短縮:-k)に変更しました
- 差分オブジェクトの書式を `20YY.MM.DD@hh;mm;ss` から `20YY.MM.DD@hh.mm.ss` に
  変更します
	+ このバージョンから反映。以前のバージョンで作成された差分は旧書式のままです
- 新着のみの更新の場合差分データを作成しないように変更しました
- `backup` コマンドで作成するZIPファイルの内部ファイルパス文字エンコーディング
  をOS毎に変更するようにしました
	+ Windows = Windows-31J、その他OS = UTF-8
- `flag` コマンドは非推奨になり、tagコマンドに統一されます。今後完結フラグを立
  てる場合、 `narou tag -a end 0` として下さい。flagコマンドは1.7.0で廃止される
	予定です
	+ flagデータをtagデータに移行する場合は `narou flag --convert-tag` を実行
	  して下さい
- 完結の情報を自動で付与するようになりました。完結を検知したら end タグを追加
  します
	+ 現在は小説家になろう関連サイトとハーメルンのみ自動検知します
- 選択肢を選ぶときエンターを押す必要がなくなりました
- このバージョンからセマンティックバージョニングに移行します
	+ Major.Minor.Teen という形式で、特別なアップデートでMajor、追加機能を含む
	  アップデートでMinor、バグ修正のみのアップデートでTeenの番号を増やします

#### Bug Fix
- 小説が掲載サイトから削除されていない時(500や503)にも自動凍結していたのを修正
- iBooksで閲覧時章タイトルページのレイアウトが崩れていたのを修正
- iBooksで閲覧時Arcadiaの掲載アドレスがあるページでエラーがでていたのを修正 #47
- ハーメルンで作者名が正常に取得できない場合があったのを修正 #48
- ハーメルンで連載形式の短編が1話目しか取得できていなかったのを修正 #49
- 自動字下げの判定処理が正常に動作していなかったのを修正
- `diff` コマンドの差分表示時に更新日が挿入されない場合があったのを修正
- `diff` コマンドで小説家になろう以外の小説の差分がHTMLタグ付きのまま表示されて
  いたのを修正
- 未対応のURLを入力した場合にエラーが出るようになっていたのを修正
- 小説家になろうの短編のあらすじで改行が無視されていたのを修正
- 小説家になろうの短編のあらすじで先頭に縦棒（｜）が入ってしまう問題に対応 #46
- 小説家になろうの挿絵を認識出来ない場合があったのを修正
- 前書き・後書き内にある挿絵を単ページ化出来なかったのを修正 #8
- 漢数字変換で対応桁数以上を変換しようとしてクラッシュしていたのを修正
- その他ヘルプ文の訂正や無駄な処理削減等多数の細かい調整

1.5.11 : 2014/07/24
-------------------
#### 追加機能もしくは仕様変更
- 改稿の更新漏れ対策として、 `update.strong` オプションが追加されました
	+ `narou s update.strong=true` として設定して下さい
	+ 改稿日の更新は必ずダウンロードされるようになります（当日はアップデートする度にDLします）。
	  何度も改稿された小説では、更新のタイミングによっては改稿内容を取りこぼす可能性があるため、
	  このオプションを有効にすることで必ず拾えるようにします
	+ ファイルのタイムスタンプをチェックするので、更新動作が多少遅くなります
- 指定の話数ごとにウェイトを入れられる `download.wait-steps` オプションが追加されました
	+ `narou s download.wait-steps=10` として設定して下さい
	+ 小説家になろうの場合は11話以上を指定しても10話ごとにウェイトが入ります
- `backup` コマンドを追加しました
	+ 使用例： `narou backup 0` 、 `narou ba 0`
	+ 小説保存フォルダ直下の backup フォルダに、バックアップ以外の全てのファイルをZIPで固めて保存します
- ダイジェスト化検出時の処理項目に「バックアップの作成」と「保存フォルダを開く」を追加しました

#### Bug Fix
- まのわ(n3730bn)のプリセット変換スクリプトの挙動を調整
- 暁で一部あらすじが正常に取れていない小説があったので修正

1.5.10.1 : 2014/07/18
---------------------
#### Bug Fix
- replace.txt による置換が正常に行えなかった問題を修正

1.5.10 : 2014/07/14
-------------------
#### 追加機能もしくは仕様変更
- `download` コマンドに対話モードを追加しました
	+ `narou d` と対象小説を指定せずに実行すると対話モードに移行します（-f 等のオプションは指定出来ます）
	+ 連続してNコードもしくはURLを入力できるモードです。ArcadiaのURLは " " で囲む必要がありません
	+ 想定される使い方：
		* 複数のURLを書いたテキストをコピペして流しこむ
		* テキストファイルからリダイレクトで入力する
			- `narou d < list.txt`
		* BATファイル等で `narou d` のみを実行し、新規DL時の入力を簡便にする
- 自動生成される converter.rb に簡単な説明を付け加えるようにしました
- `remove` コマンドの `--with-file` オプションに短縮版 `-w` を追加しました
- `narou init` 実行時に現在の AozoraEpub3 の場所を表示するようになりました
- `update` コマンドに新着小説のみを変換するオプション `--convert-only-new-arrival` (短縮 `-a` )が
  追加されました（naoh87さんによる実装）
	+ もしこのオプションをデフォルトの挙動にしたければ、 `narou s default_args.update=-a` として下さい
- 変換用のプリセットデータを追加
	+ デスマーチからはじまる異世界狂想曲(n9902bn)
	+ この世界がゲームだと俺だけが知っている(n9078bd)
	+ まのわ ～魔物倒す・能力奪う・私強くなる～(n3730bn)
- すでに同梱されているプリセットデータを一部更新
	+ 異世界迷宮で奴隷ハーレムを(n4259s)
	+ ログ・ホライズン(n8725k)

#### Bug Fix
- replace.txt で置換対象を削除するという表現（あいう<tab><改行>）が出来なかったのを修正
- `--time` オプションで表示される実行時間がより正確になるように調整しました

1.5.9 : 2014/07/04
------------------
#### Bug Fix
- 作者名が半角数字だけの場合にクラッシュする問題を修正

1.5.8 : 2014/06/25
------------------
#### 追加機能もしくは仕様変更
- 小説が削除されていた場合に自動で凍結するようになりました
- 小説が削除されている場合に `list` コマンドで（削除）と表示されるようになりました
- 更新に失敗した小説を表示するときにIDも合わせて表示するようにしました
- `flag` コマンドに強制設定用の `--on` 及び `--off` オプションを追加しました
- `flag` コマンドに `delete` フラグを追加しました（削除表示への対応）
- ルビの拗音（ぁ、ぃ、ゃ等）を商業書籍のように大きくする機能を追加しました
	+ `narou s force.enable_ruby_youon_to_big=true` とするか、
	  setting.ini に `enable_ruby_youon_to_big=true` を追加して下さい（標準ではオフ）
- 今バージョン以降ダウンロードした小説は、小説タイトルが変わっても converter.rb に関するエラーが
  発生しないように調整しました。ただし、すでにダウンロード済み小説には適用されないため、エラーが出た場合は
  converter.rb の削除で対応をお願いします

1.5.7.1 : 2014/06/15
--------------------
#### 追加機能もしくは仕様変更
- 10話ごとの制限が復活していたので、1.5.7で外したウェイトを復活させました

1.5.7 : 2014/06/14
------------------
#### 追加機能もしくは仕様変更
- 小説家になろうにおいて、10話ごとにかけていたウェイトを削除

#### Bug Fix
- &#39; (') のエンティティ変換を追加

1.5.6.1 : 2014/06/06
--------------------
#### 追加機能もしくは仕様変更
- タイトルにつく更新日の日付を新着があった日付に変更

#### Bug Fix
- 初期化時に `narou init` を実行できない問題を修正

1.5.6 : 2014/06/04
------------------
#### 追加機能もしくは仕様変更
- 小説のタイトルに更新日をつける機能を追加しました
	+ `narou s force.enable_add_date_to_title=true` とするか、
	  setting.ini に `enable_add_date_to_title=true` を追加して下さい（標準ではオフ）
	+ 書式は `title_date_format` 、位置は `title_date_align` で自由に変更出来ます
		* title_date_format: 付与する日付のフォーマット。書式は http://bit.ly/1m5e3w7 を参照
		* title_date_align: 付与する日付の位置。left か right
		* `narou s force.title_date_format="(%-m/%-d)"`
		* `narou s force.title_date_align=left`
- `flag` コマンドを追加しました
	+ `narou flag end 10` と指定出来ます
	+ 現在は end（完結フラグ）のみ指定できます。`list` コマンド及び、小説タイトルに (完結) と表示されるようになります
	 （小説タイトルについては次の変換から反映）
- 小説の管理フォルダ(narou initしたところ)に `device` フォルダをつくることで、 `send` コマンド用の設定ファイルを
  独自に用意出来るようになりました
	+ 設定ファイルは https://github.com/whiteleaf7/narou/tree/master/lib/device を参考に作成して下さい

#### Bug Fix
- !?の一文字表記（0x2049）等でゴミが出てしまう問題を修正

1.5.5.1 : 2014/05/15
--------------------
#### Bug Fix
- 暁の小説で一部正常にDLできないものがあったので修正

1.5.5 : 2014/05/15
------------------
#### 追加機能もしくは仕様変更
- 小説投稿サイト **[暁](http://www.akatsuki-novels.com/)** に対応しました

#### Bug Fix
- タイトルに " が含まれている場合に正常に変換できない問題を修正

1.5.4 : 2014/03/21
------------------
#### 重要な修正
- 小説家になろうの仕様変更で更新できなくなっていたのを修正しました

1.5.3 : 2014/03/13
------------------
#### 追加機能もしくは仕様変更
- MacとLinuxでもsendコマンド時にOSのcpコマンドを使ってファイルを送信するようにした

1.5.4 : 2014/03/21
------------------
#### 重要な修正
- 小説家になろうの仕様変更で更新できなくなっていたのを修正しました

1.5.3 : 2014/03/13
------------------
#### 追加機能もしくは仕様変更
- 小説の最後に「（本を読み終わりました）」と表示されるようになりました
	+ setting.ini で `enable_display_end_of_book` を false 、もしくはコマンドで
	  `narou s force.enable_display_end_of_book=false` とすることで抑制出来ます

#### Bug Fix
- ◯つき数字などがまじると文字化けする可能性があった問題を修正

1.5.2.1 : 2014/03/09
--------------------
#### Bug Fix
- 1.5.2 で発生する新規小説DL時のエラーを修正

1.5.2 : 2014/03/09
------------------
#### 追加機能もしくは仕様変更
- **Cygwin** に対応しました（laplace22さんによる実装）
- `narou mail` コマンドを追加しました
	+ 主にSend to Kindleを使うことを想定したコマンドです。送信用にメールアドレスが必要です
	+ 初めて `narou mail` コマンドを使った際に、自動で設定用ファイルが作成されます。そのファイルを
	  編集することで初めてコマンドが使えるようになります
- setting.ini の `enable_transform_date` をデフォルトで false に変更（新規DLから反映）

#### Bug Fix
- ハーメルンで前書き後書きが正常に取得出来ない問題を修正
- ハーメルンでダウンロード時にエラーが出る場合があった問題を修正 #43

1.5.1 : 2014/03/07
------------------
#### 追加機能もしくは仕様変更
- `narou d Nコード1,Nコード2,URL1 --multiple` のように、スペース区切り以外に `,` で区切れる機能を追加しました
	+ 有効にするには `--multiple` オプションを付けて下さい
	+ 区切り文字を `,` から変更するには `narou s multiple-delimiter=区切り文字` と設定して下さい

#### Bug Fix
- ルビ記号が入れ子になっている時に正常にルビ化できていなかった問題を修正
- NKFによって全角ダッシュ（u2015）が全角マイナス？（u2014）に変換されてしまう問題を修正
- サブタイトルにタブ文字が入っている場合にダウンロード中にエラーが出る問題を修正
- ノクターンノベルズ及びムーンライトノベルズをNコードを指定して２個以上同時にダウンロードした場合に、
  ２個目以降が正常にDL出来ない問題を修正

1.5.0.2 : 2014/03/06
--------------------
#### 追加機能もしくは仕様変更
- `narou list` で（短編）の表示色がグレーになります

#### Bug Fix
- 1.5.0 でルビが全滅するバグが混入したのでルビ処理を以前の状態に戻しました

1.5.0.1 : 2014/03/06
--------------------
#### Bug Fix
- 1.5.0 で小説家になろうの連載小説が正常にダウンロードできなくなっていたのを修正

1.5.0 : 2014/03/06
------------------
#### 追加機能もしくは仕様変更
- 小説投稿サイト **[ハーメルン](http://syosetu.org/)** に対応しました
- 小説投稿サイト **[Arcadia](http://www.mai-net.net/)** に対応しました
	+ Arcadiaは `narou d "http://www.mai-net.net/bbs/sst/sst.php?～略～&n=0&count=1"` のように
	  URLを " で囲まないとコマンドがきちんと通りませんのでご注意下さい
- このバージョン以降ダウンロードした小説の保存フォルダ名には、タイトルの前にIDが付加されるようになりました
- アラビア数字を漢数字に変換しないパターンを追加（％や単位系）
- `setting.ini` の項目、 `enable_narou_illust` が `enable_illust` に変更になりました

#### Bug Fix
- `narou browser --vote` コマンドがなろうのレイアウト変更に対応していなかったので修正
- 半角カナを全角カナに変換するように修正 #36
- 小説のタイトルにはルビをふれないように修正 #37

1.4.6 : 2014/02/28
------------------
#### 追加機能もしくは仕様変更
- `narou diff` コマンドに(凍結済を除く)全ての小説の差分データを削除する `--all-clean` オプションが追加されました

#### Bug Fix
- 傍点化の処理が特殊な状況下で Index Error を吐いて止まっていた問題を修正

1.4.5 : 2014/02/27
------------------
#### 追加機能もしくは仕様変更
- `narou send` コマンドに凍結済み小説は送信しない `--without-freeze` オプションが追加されました
	+ 送信小説を個別に指定した場合は無視されます
	+ `narou s send.without-freeze=true` と設定することで、オプションを毎回打たなくても有効になります

#### Bug Fix
- 検索除外されている小説が全て短編小説と認識されてしまう問題を修正
- WinMerge2.14で `narou diff` コマンドが使えなかった問題を修正
- Ruby1.9.3で動かなくなっていたのを修正
- 行頭に三点リーダーの代わりに連続中黒（・・・）が来た時自動字下げがされていなかったのを修正 #35
- 連続で小説をダウンロードする時に 503 エラーがでてしまう場合がある問題を修正

1.4.4 : 2014/02/26
------------------
#### 追加機能もしくは仕様変更
- **短編小説** に対応しました
	+ `narou list` コマンドで短編小説にはタイトルの後ろに（短編）と付きます
- `narou list` コマンドが拡張されました
	+ 一覧の表示を絞る `--filter` オプションを追加しました（短縮 -f）
		- `--filter` に続いて `series` （連載）、`ss` （短編）を指定出来ます
		- コマンド例： `narou list --filter series` 連載小説のみを表示する
		- コマンド例： `narou list -f ss -rl` 短編小説のみを更新の古い順に表示する
	+ 表示する項目を増やす `--type` オプションを追加しました（短縮 -t）
		- オプションを指定すると「種別」という項目が追加され、「連載」か「短編」かが表示されます
- `narou remove` コマンドに全ての短編小説を削除する `--all-ss` オプションが追加されました
	+ ファイルも全て消すには通常通り `--with--file` オプションを同時に付ける必要があります
- `narou download` コマンドにダウンロードが終わったあと削除する `--remove` オプションが追加されました（短縮 -r）
	+ 更新をチェックする必要があまりない短編小説などのためのオプションです
	+ 小説データフォルダ下にファイルは残っているので、ダウンロード時に送信まで行わなかった場合は、手動で
	  書籍データをコピーすることが出来ます。また、ファイルを消す場合も手動で削除する必要があります

#### Bug Fix
- 検索除外設定されている小説がダウンロード出来ない問題を修正

1.4.3 : 2014/02/24
------------------
#### 追加機能もしくは仕様変更
- **i文庫** に対応しました。専用のzipアーカイブを生成出来るようになります（txtと表紙、挿絵をzipで固めたもの）
	+ `narou s device=ibunko` で切り替えることが出来ます
	+ Drobbox等と連携をするために、 `narou s convert.copy_to=フォルダのパス` を設定することで、
	  zipファイルがコピーされるようになります
	+ i文庫専用レイアウトテンプレート、ibunko_novel.txt.erb が追加されました
	+ `narou convert` コマンドに `--no-zip` オプションが追加されました
- `setting.ini` に濁点フォントの埋め込みを制御できる `enable_dakuten_font` が追加されました
- あらすじ及び章も変換処理を施すように変更しました
	+ `converter#before` 及び `after` メソッドの text_type に、 `story` `chapter` が渡されるようになりました

#### Bug Fix
- Windowsにおいて、タイトル及び作者名にCP392外の文字が使われていた場合に変換がエラーになる問題を修正
	+ 変換時にエラーになった小説において、まだエラーが出る場合は一度削除（ `narou remove --with-file 小説ID` ）
	  して再ダウンロードをお願いします
- 章タイトルが※で終わる小説をEPUB変換時に警告が出ていたのを修正

1.4.1.1 : 2014/02/20
--------------------
#### Bug Fix
- `narou init` 時にエラーが出るようになっていたのを修正

1.4.1 : 2014/02/20
------------------
#### Bug Fix
- 1.4.0 で章情報が取得できていなかったのを修正

1.4.0 : 2014/02/20
------------------
#### 重要な修正
- 小説家になろうのレイアウト変更によって更新処理ができなくなっていたものを修正しました

1.3.5.1 : 2014/02/03
--------------------
#### Bug Fix
- 過去バージョンとの互換性維持のため、フォルダ名のみ末尾スペースを削除するように変更

1.3.5 : 2014/02/03
------------------
#### Bug Fix
- 小説を削除したあと再度ダウンロードしようとした場合にエラーが出ていたのを修正
- タイトル名の末端に半角スペースがある小説が正常にダウンロード出来ない問題を修正

#### 追加機能もしくは仕様変更
- 小説変換プリセットに n2525bs (魔剣ゾルディの女主人公とっかえひっかえ成長記録) 追加
- ダウンロードが完了した時に同時に凍結させるオプションを追加
	+ `download` コマンドに `--freeze` (短縮名 -z) オプションが追加されました
		* コマンド例： `narou download --freeze n4029bs`
		* コマンド例： `narou d n4029bs -z`
- Mac上での動作改善コードの取り込み（https://github.com/yossoy/narou）
	+ java の動作不良対応、Kindle 対応

2013/12/25 : **1.3.4**

#### Bug Fix
- `narou init` 時に "" で囲まれたパスを認識できない不具合を修正

2013/10/30 : **1.3.3**

#### 追加機能もしくは仕様変更
- 送信対応端末に **SonyReader(PRS-T2)** を追加
	+ `narou setting device=reader` で切り替えることが出来ます

2013/10/29 : **1.3.2**

#### 追加機能もしくは仕様変更
- `default_args.*` の設定が使われるのは、各コマンドの引数が省略された時だけに変更
- 各端末のボリュームラベルを大文字小文字区別しないで認識するように変更（Windowsのみ）
- ダイジェスト化の自動検知機能を搭載。更新するかしないか、凍結してしまうかを選択可能に

2013/09/13 : **1.3.1**

#### Bug Fix
- 章情報の編集に対応できていなかったので修正
	+ 本アップデート以前にダウンロードした小説には反映されません。 `narou d -f` コマンドで強制上書きして下さい
- 1.3.0.1 の修正で※が正しく区切り記号として認識されなくなっていたのを修正
- タイトルが数字だけの場合に余分に空白が入ってしまうのを修正

#### 追加機能もしくは仕様変更
- 漢数字化しない場合、一桁のアラビア数字は全角化するように変更
- タイトルのアラビア半角数字で特殊な処理を追加
	+ 行頭にある3桁の半角アラビア数字は全角化せず縦中横にする

2013/09/03 : **1.3.0.1**

#### Bug Fix
- ※記号の外字注記化コードによって正常に変換できなくなった問題を修正

2013/09/02 : **1.3.0**

#### Bug Fix
- `<PBR>` を使った場合にクラッシュする問題を修正
- `1,000` のようにカンマで区切られた半角数字の変換が変なふうに縦中横になっていたのを横に倒すように修正
- ※記号の直後に縦中横などの青空注記が来る場合に外字注記と誤認識されてしまう問題を修正
- `enable_kanji_num_with_units` が `enable_convert_num_to_kanji` の設定を無視して有効になっていたのを修正
- `enable_convert_num_to_kanji` がサブタイトルでも有効になっていたのを修正
	+ サブタイトルでは漢字変換を無効にする方針（原文尊重）
- 漢数字の再変換がおかしかったのを修正

#### 追加機能もしくは仕様変更
- 漢字の二じゃなくて間違えてカタカナのニを使ってるのを校正する
- `list` コマンドで新着を取得してから6時間以内の小説だけ新着色になるように修正
- `⇒` が Kindle Paperwhite のフォントで縦書き時に回転しないので、 `→` に置換するようにした
	+ 他の端末では確認できていないので、とりあえず narou s device=kindle に設定してある場合のみ置換する
- かぎ括弧内のとじ開きが正しくされているかどうか調査する設定を、デフォルトでオフに変更
	+ すでに setting.ini が書きだされている小説は対象外
- 携帯用改行タグ `<KBR>` でも改行するように変更

2013/08/03 : **1.2.9**

#### Bug Fix
- 小説のタイトルに < 及び > が含まれている場合にエラーになっていた問題を修正
- タイトルが二重に表示されてしまうバグがまだ発生したので修正

#### 追加機能もしくは仕様変更
- raw フォルダにテキストデータをそのまま保存する機能を追加
- ライセンスを MIT に設定しました（過去のバージョンに遡って適用します）

2013/07/26 : **1.2.8**

#### Bug Fix
- なろうの仕様変更でタイトルがたまに二重に表示されてしまうバグ（？）に対処

2013/06/12 : **1.2.7**

#### 追加機能もしくは仕様変更
- 小説更新時及び `list` コマンドで新着話数があるかどうかを目視出来るようにした
	+ 更新時はタイトル横に (新着) 表示
	+ list コマンドでは当日に新着のあった小説の日付が紫になる
		- 新着表示が優先で、新着がなくて更新だけの場合は緑になる

2013/05/17 : **1.2.6**

#### Bug Fix
- `convert` コマンドで直接テキストファイルを変換時に電子書籍デバイスへ送信できなかった不具合を修正

#### 追加機能もしくは仕様変更
- `list` コマンドでその日に更新された小説の日付を緑にして分かりやすくした
- 電子書籍デバイスへの自動送信で Kindle Fire/HD に対応（動作未確認）

2013/05/08 : **1.2.5.1**

#### fix: 新規DL時にエラーが出る可能性あったので修正

2013/05/07 : **1.2.5**

#### Bug Fix
- 連続する文頭全角空白をすべてルビ対象外に
- Mac OS X での動作状況を改善

#### 追加機能もしくは仕様変更
- 連続空行の改ページ化設定をデフォルトでオフに変更

2013/04/20 : **1.2.4**

#### Bug Fix
- 自動行頭字下げの判定方法を調整(括弧等を除いた行に対する割合で計算するように変更)
- かぎ括弧内自動連結時に、行末が！？で次の行頭が漢数字だった場合に全角空白が入らなかった問題を修正加
- 更新チェック時にサブタイトルもチェックするようにした
- サブタイトルの中の2桁以下の半角アラビア数字を強制縦中横化するようにした
	+ AozoraEpub3 の仕様で見出し内の自動縦中横化働かないため

#### 追加機能もしくは仕様変更
- サブタイトルの数字は漢数字化しないように変更
- 区切り記号にタブを追加(preset/bordersymbols.txt)
- 手動折り返しの自動連結をしないパターンに、行頭三点リーダーおよび全角ダッシュを追加
- `download --force` 時に強制上書きする以前の仕様に戻した
- 連続した句読点を三点リーダーに変換するようにした
- 一定以上連続する空行を改ページに変換
	+ `setting.ini` に `enable_convert_page_break` 及び `to_page_break_threshold` を追加
- 「Ｒｅ：ゼロから始める異世界生活」用の変換設定を追加

2013/04/01 : **1.2.3**

#### 三点（二点）リーダーの偶数化が正常に動いていなかったのを修正

#### 更新失敗時のエラーメッセージを分かりやすくした

#### auto_indent で青空注記まで字下げされていたのを修正

2013/03/29 : **1.2.2**

#### Bug Fix
- 濁点付き文字の処理に不具合があったのを修正
- 表紙画像がないときはAozoraEpub3に表紙指定をしないように修正（表紙がなくて挿絵がある場合対策）

2013/03/23 : **1.2.1**

#### Bug Fix
- ノノカギのとじ忘れがあると以降のノノカギのとじ開きが逆になってしまうバグを修正
	* この修正によって改行を含んだノノカギでおかしくなるが、仕様とする
- 濁点フォント(DMincho.ttf)に含まれていない文字は縦中横の擬似表現にする
- アラビア数字の漢数字化がちゃんと変換できていなかったのを修正

#### 追加機能もしくは仕様変更
- `send` コマンドで管理する全ての小説を送信する機能追加
	* `send` を引数なしで実行することで、端末にある書籍データより新しければ送信する
- DMincho.ttfの濁点対応文字を増やした（ι゛ および カタカナに濁点）。 **narou init でAozoraEpub3の再設定が必要です**
- コマンドのデフォルトのオプションを指定できる機能を追加
	* `narou setting default_args.コマンド名="オプション"` で設定出来ます。注意：これは、直接コマンドを発行した時のみ有効です。
	  他のコマンド経由で呼ばれる場合には有効にはなりません。

	```
	# 使用例
	# list コマンドで、「更新日の」「古い順」に表示するオプションを設定(リストが長くなった時に便利)
	narou setting default_args.list="-lr"
	# オプションを指定しなくても、default_args.listで設定したオプションが使われる
	narou list

	# 削除確認メッセージ毎回表示しない
	narou setting default_args.remove="-y"
	narou remove 0
	```

2013/03/19 : **1.2.0**

#### Bug Fix 及び機能改善
- Windows以外のOSでの動作状況を改善しました(Ubuntu Linuxで確認。Mac OS Xは未確認だが恐らく動くはず)
	+ Nコードを指定した場合にエラーが出ていたのを修正
	+ AozoraEpub3の出力をうまく扱えていなくエラーが出ていたのを修正
	+ Linuxでも `folder` 及び `browser` コマンドを使えるように改善
	+ `send` コマンドでデバイスへ送信出来るように(Linuxのみ確認、Mac OS Xは未確認)
		- /media もしくは /mnt を探します。送信出来ない場合はこのフォルダにマウントされているか確認して下さい
- shebangの記述をちゃんと動くように修正(gem でインストールした場合は影響なし)
- --no-color 時の処理の最適化

#### 追加機能もしくは仕様変更
- 漢数字の単位化下限のデフォルトを3桁から4桁へ変更(kanji_num_with_units_lower_digit_zero=3)
	+ `100 → 一〇〇、1000 → 千` と変換される
- 章タイトルページの柱の位置調整
- 行頭二分アキをいれる対象にノノカギ（〝）を追加
- ！？の直後に全角アキを自動挿入しないパターンに閉じノノカギ（〟）を追加
- 小説のDL時に最初から用意された変換設定を適用する機能追加
	+ 以下の小説の設定を同梱しました（気まぐれで増えていきます）
		- [オーバーロード：後編](http://ncode.syosetu.com/n1839bd/)
		- [異世界迷宮で奴隷ハーレムを](http://ncode.syosetu.com/n4259s/)
		- [ログ・ホライズン](http://ncode.syosetu.com/n8725k/)
		- [無職転生　- 異世界行ったら本気だす -](http://ncode.syosetu.com/n9669bk/)

2013/03/18 : **1.1.2.1**

#### Bug Fix
- Linuxで実行不可能になるエラー修正

2013/03/17 : **1.1.2**

#### Bug Fix
- Fiddleがない環境でエラーになってたので修正
- 同一行に（）と《》のルビが混在していた時に正しく処理出来ていなかったのを修正
- 短編小説をDLしようとした時にDL出来ない旨メッセージを表示するように
- ！？の縦中横化で自然ではない変換パターンに対応

#### 追加機能もしくは仕様変更
- なろうのルビ仕様に追随
	+ 全角空白もルビ対象として許容する
	+ サブタイトルのカッコはルビをふらない
- 中黒(・)を３個以上連続して使っているのを三点リーダーに変換する機能実装
	+ `setting.ini` に `enable_convert_horizontal_ellipsis` を追加
- 表示を若干色つけするように
	+ 色つけを抑制にするには `--no-color` オプションか `narou s no-color=true` で
- 節のタイトル（中見出し）の位置を若干調整 (template/novel.txt.erb)

2013/03/09 : **1.1.1**

#### Bug Fix
- URL文字列のリンクを a タグに変更し忘れ修正
- update コマンドにIDを直指定した時の変換時に不正な引数を渡していたのを修正

#### 追加機能もしくは仕様変更
- 三点リーダーの偶数化を１つからするように変更

2013/03/07 : **1.1.0**

#### Bug Fix
- xhtml_nav.vm の＜/ol＞＜/li＞が過剰付与だったのを修正
- ｜《るび》　な場合、ルビ化を無効にする（なろうの仕様に追随）

#### 追加機能もしくは仕様変更
- Ruby2.0.0対応

2013/03/07 : **1.1.0.rc2**

#### Bug Fix
- `update` コマンドに存在しない小説を指定した場合にエラーが出るバグを修正
- `convert -o` オプションが正常に動いていなかったバグを修正
- テキストファイル変換時のバグ修正

#### 追加機能もしくは仕様変更
- `update` コマンドで全ての小説を更新する場合、 `convert.no-open` の設定にかかわらず
	保存フォルダは開かないようにした
- 18禁小説をDL時に年齢認証をするようにした
- ルビの大きさは 0.6em に調整

2013/03/02 : **1.1.0.rc1**

#### 1.1.0の正式リリースに向けてのテストリリース
   (1.0 系はテスト用非公開バージョン)

2013/02/24 : **1.0.0**

#### first release (closed beta version)
